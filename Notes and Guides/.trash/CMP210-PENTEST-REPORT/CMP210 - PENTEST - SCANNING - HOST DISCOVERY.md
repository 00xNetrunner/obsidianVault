---
sticker: emoji//1f927
---
In order to commence any network-related operation, the preliminary step involves identifying the target machines that are subject to attack. This can be accomplished by utilizing the **netdiscover tool**.  
  
The **netdiscover** tool enables us to perform an IP address range scan, thereby facilitating the detection of the machines present within our network.

command used: ~ 
```bash
netdiscover -r 192.168.10.0/24
```
![[Pasted image 20231222143524.png|Figure 1 - netdiscover scan]]


- 192.168.10.2 - *Server2*
- 192.168.10.2 - *Server1*
- 192.168.10.10 - *Client*
- 192.168.10.254 - *Kali Linux Machine*

Now that the IPs for server one and server two have been obtained, an **NMAP** scan will be performed to identify open ports, services running on each port, and the underlying operating system. A bash script has been developed for this purpose, enabling the scan to be executed even when the user is not present.

- The Script used for the scan. (*This will be added to the appendix of the final report*)
```bash
#!/bin/bash
# Author: 00xNetrunner
# Created: 12/23/2023
# Description:~ 
# This script is designed to automate nmap scans for multiple IP addresses.
# It includes both TCP and UDP scans with specified scan types and port ranges.

# Function: perform_scan
# Purpose: To execute an nmap scan on a given IP address with specified scan parameters.
# Parameters:
#   - ip: The target IP address for the scan.
#   - scan_type: Type of scan to be performed (e.g., -sT for TCP scan).
#   - ports: Range of ports to scan.
#   - extra_args: Additional nmap arguments for more detailed scanning.
perform_scan() {
    local ip=$1
    local scan_type=$2
    local ports=$3  # String specifying the port range for the scan.
    local extra_args=$4
    local timestamp=$(date +"%Y-%m-%d_%H-%M-%S")  # Generating a timestamp for file naming.
    local file_name="${ip}_${scan_type}_${timestamp}"  # Naming format for output files.
    local log_file="scan_log_${timestamp}.txt"  # Log file to record scan activity.

    # Logging the start of the scan to both the console and the log file.
    echo "[$(date)] Starting ${scan_type} scan on ${ip}..." | tee -a "${log_file}"
    
    # Executing the nmap command with specified parameters and outputting results in text and XML formats.
    nmap $scan_type -p "$ports" $extra_args -oN "${file_name}.txt" -oX "${file_name}.xml" $ip

    # Checking the exit status of the last command (nmap scan).
    if [ $? -eq 0 ]; then
        # Logging successful scan completion.
        echo "[$(date)] ${scan_type} scan on ${ip} completed successfully." | tee -a "${log_file}"
    else
        # Logging any errors occurred during the scan.
        echo "[$(date)] Error occurred during ${scan_type} scan on ${ip}." | tee -a "${log_file}"
    fi
}

# Script execution starts here.
# Checking for the presence of at least one command-line argument (IP address).
if [ $# -lt 1 ]; then
    echo "Usage: $0 <IP-address-1> [IP-address-2] ..."
    exit 1
fi

# Defining port ranges for TCP and UDP scans.
tcp_ports="1-65535"  # Full range of TCP ports.
udp_ports="1-500"    # Specified range of UDP ports.

# Looping through all IP addresses provided as command-line arguments.
for ip in "$@"; do
    # Performing a comprehensive TCP scan with verbose output and various scan techniques.
    perform_scan "$ip" "-sT" "$tcp_ports" "-vv -T5 -sV -O --osscan-guess --script=banner,vuln,exploit -A"

    # Performing a UDP scan with a delay between probes and various scan techniques.
    perform_scan "$ip" "-sU" "$udp_ports" "-vv --scan-delay 1s -sV --script=banner,vuln -A"
done

```
> The script is designed to scan all TCP ports and attempt to deduce the operating system in use. For UDP scans, it focuses on the first 500 ports, given the typically longer duration of UDP scans. Additionally, the script archives the Nmap scan results in two formats: a text file for direct reading and an XML file, facilitating importation into Metasploit.

![[Pasted image 20231224120936.png|Figure 2 - Running the nmap scan with a custom script]]
# Scan Summaries 

## 📋 Nmap TCP Scan Report for 192.168.10.1 

### 🌐 General Information
- **IP Address:** 192.168.10.1
- **MAC Address:** 00:0C:29:06:40:42 (VMware)
- **Operating System:** Microsoft Windows Server 2019
- **Device Type:** General purpose

### 🚪 Open Ports & Services
1. **Port 21/TCP (FTP)**
   - Service: FTP Server
   - 🛡️ Vulnerabilities: None found specific to this server; general FTP vulnerabilities to consider.

2. **Port 22/TCP (SSH)**
   - Service: OpenSSH for Windows 8.6
   - 🛡️ Vulnerabilities: None found.

3. **Port 25/TCP (SMTP)**
   - Service: ArGoSoft Freeware smtpd 1.8.2.9
   - 🚨 Vulnerabilities: CSRF allowing remote arbitrary code execution (similar to ArGo Soft Mail Server 1.8.8.9)【27†source】.

4. **Port 53/TCP (Domain)**
   - Service: Simple DNS Plus
   - 🚨 Vulnerability: Denial of service via DNS reply packets (CVE-2008-3208)【31†source】.

5. **Port 79/TCP (Finger)**
   - Service: ArGoSoft Mail fingerd
   - 🛡️ Vulnerabilities: None found.

6. **Port 80/TCP (HTTP)**
   - Service: HttpFileServer httpd 2.3
   - 🚨 Vulnerabilities:
     - Invalid-pointer write access violation (CVE-2020-13432)【35†source】.
     - Remote code execution via %00 sequence (CVE-2014-6287)【36†source】.
     - RCE vulnerabilities (CVE-2023–32629, CVE-2023–2640)【37†source】.

7. **Port 88/TCP (Kerberos-sec)**
   - Service: Microsoft Windows Kerberos
   - 🚨 Vulnerabilities:
     - Digital alteration of PAC signatures【41†source】.
     - Elevation of Privilege (CVE-2022-37967)【42†source】.
     - Old vulnerabilities in Kerberos protocol【43†source】.
     - Security feature bypass in KDC【44†source】.

8. **Port 90/TCP (HTTP)**
   - Service: Apache httpd (PHP 5.6.30)
   - 🛡️ Vulnerabilities: None found specific to this version; general PHP vulnerabilities to consider【50†source】.

9. **Port 110/TCP (POP3)**
   - Service: ArGoSoft freeware pop3d 1.8.2.9
   - 🚨 Vulnerability: CSRF allowing remote arbitrary code execution (similar to ArGo Soft Mail Server 1.8.8.9)【56†source】.

### 🔑 Recommendations
- **🔧 Update & Patch:** Regularly update and patch all services.
- **⚙️ Configuration Review:** Check for potential security weaknesses in configurations.
- **🔍 Regular Scanning:** Continuously monitor for vulnerabilities.
- **🔒 Security Policies:** Implement strong security measures like access controls and firewalls.


## 📡 Nmap UDP Scan Report for 192.168.10.1

### 🌐 General Information
- **IP Address:** 192.168.10.1
- **MAC Address:** 00:0C:29:06:40:42 (VMware)
- **Operating System:** Windows (Exact OS details not specified due to multiple fingerprint matches)
- **Device Type:** General purpose

### 🚪 Open Ports & Services
1. **53/udp (Domain)**
   - Service: Simple DNS Plus
   - 🚨 Vulnerabilities: Potential DNS vulnerabilities.

2. **67/udp, 68/udp (DHCP)**
   - Service: DHCP Server/Client
   - 🛡️ Vulnerabilities: None found.

3. **88/udp (Kerberos-sec)**
   - Service: Microsoft Windows Kerberos
   - 🚨 Vulnerabilities: Multiple Kerberos protocol vulnerabilities.

4. **123/udp (NTP)**
   - Service: NTP v3
   - 🛡️ Vulnerabilities: None found specific to this version.

5. **137/udp (NetBIOS-NS)**
   - Service: Microsoft Windows NetBIOS Name Service
   - 🛡️ Vulnerabilities: Potential NetBIOS related vulnerabilities.

6. **138/udp, 161/udp, 464/udp, 500/udp (NetBIOS-DGM, SNMP, Kpasswd5, ISAKMP)**
   - Services: Various network services
   - 🛡️ Vulnerabilities: None found specific to these services.

7. **389/udp (LDAP)**
   - Service: Microsoft Windows Active Directory LDAP
   - 🛡️ Vulnerabilities: None found specific to this service.

### 🔑 Recommendations
- **🔧 Update & Patch:** Regularly update and patch all services.
- **⚙️ Configuration Review:** Check for potential security weaknesses in configurations.
- **🔍 Regular Scanning:** Continuously monitor for vulnerabilities.
- **🔒 Security Policies:** Implement strong security measures like access controls and firewalls.


-----


------

-----
## 📋 TCP Nmap Scan Report for 192.168.10.2

### 🌐 General Information
- **IP Address:** 192.168.10.2
- **MAC Address:** 00:0C:29:77:ED:8D (VMware)
- **Operating System:** Microsoft Windows Server 2019
- **Device Type:** General purpose

### 🚪 Open Ports & Services

1. **22/tcp (SSH)**
   - Service: OpenSSH for Windows 8.6
   - 🚨 Vulnerabilities:
     - Integrity check bypass in SSH transport protocol【76†source】.
     - Observable discrepancy leading to information leak【77†source】.
     - Elevation of privilege vulnerability【78†source】.
     - RCE vulnerability in SSH-agent's forwarded feature【79†source】.

2. **53/tcp (Domain)**
   - Service: Simple DNS Plus
   - 🚨 Vulnerabilities: Denial of service via multiple DNS reply packets【83†source】.

3. **88/tcp (Kerberos-sec)**
   - Service: Microsoft Windows Kerberos
   - 🚨 Vulnerabilities:
     - Digital alteration of PAC signatures

     - Elevation of privilege vulnerability
     - Vulnerabilities in Microsoft's implementations of Kerberos protocol
     - Security feature bypass in KDC

4. **90/tcp (HTTP)**
   - Service: Apache httpd
   - 🚨 Vulnerabilities:
     - Multiple vulnerabilities including out-of-bounds read, DoS, HTTP/2 stream memory issues, and HTTP request smuggling 

5. **135/tcp (MSRPC)**
   - Service: Microsoft Windows RPC
   - 🛡️ Vulnerabilities: None found.

6. **139/tcp (NetBIOS-SSN)**
   - Service: Microsoft Windows netbios-ssn
   - 🛡️ Vulnerabilities: None found.

7. **389/tcp (LDAP)**
   - Service: Microsoft Windows Active Directory LDAP
   - 🛡️ Vulnerabilities: None found.

8. **445/tcp (Microsoft-DS?)**
   - Service: Microsoft Windows Server
   - 🛡️ Vulnerabilities: None found.

9. **464/tcp (Kpasswd5?)**
   - Service: Microsoft Windows Kerberos
   - 🚨 Vulnerabilities: Related to Kerberos protocol.

10. **593/tcp (NCACN-HTTP)**
    - Service: Microsoft Windows RPC over HTTP 1.0
    - 🛡️ Vulnerabilities: None found.

11. **636/tcp (TCPwrapped)**
    - Service: Unknown
    - 🛡️ Vulnerabilities: None found.

12. **2154/tcp (HTTP)**
    - Service: HttpFileServer httpd 2.3
    - 🚨 Vulnerabilities: Multiple vulnerabilities in Apache HTTP Server.

13. **3268/tcp, 3269/tcp (LDAP)**
    - Service: Microsoft Windows Active Directory LDAP
    - 🛡️ Vulnerabilities: None found.

14. **3389/tcp (MS-WBT-Server)**
    - Service: Microsoft Terminal Services
    - 🛡️ Vulnerabilities: None found.

15. **5985/tcp (HTTP)**
    - Service: Microsoft HTTPAPI httpd 2.0
    - 🛡️ Vulnerabilities: None found.

16. **9389/tcp (MC-NMF)**
    - Service: .NET Message Framing
    - 🛡️ Vulnerabilities: None found.

17. **47001/tcp (HTTP)**
    - Service: Microsoft HTTPAPI httpd 2.0
    - 🛡️ Vulnerabilities: None found.

18. **Various Ports (MSRPC, NCACN-HTTP)**
    - Services: Microsoft Windows RPC and RPC over HTTP 1.0
    - 🛡️ Vulnerabilities: None found.

### 🔑 Recommendations
- **🔧 Update & Patch:** Regularly update and patch all services, especially those with known vulnerabilities.
- **⚙️ Configuration Review:** Check for potential security weaknesses in configurations.
- **🔍 Regular Scanning:** Continuously monitor for vulnerabilities.
- **🔒 Security Policies:** Implement strong security measures like access controls
 and firewalls.

## 📡 UDP Nmap Scan Report for 192.168.10.2

### 🌐 General Information
- **IP Address:** 192.168.10.2
- **MAC Address:** 00:0C:29:77:ED:8D (VMware)
- **Operating System:** Windows (Specific OS details indeterminate)
- **Device Type:** General purpose

### 🚪 Open Ports & Services

1. **53/udp (Domain)**
   - Service: Simple DNS Plus
   - 🚨 Vulnerability: Denial of service via multiple DNS reply packets (CVE-2008-3208)【132†source】

2. **67/udp, 68/udp (DHCP)**
   - Service: DHCP Server/Client
   - 🚨 Vulnerability: DHCP core library (dhcpcore.dll) vulnerable to malicious DHCP reply packets (CVE-2019-0547)【173†source】

3. **88/udp (Kerberos-sec)**
   - Service: Microsoft Windows Kerberos
   - 🚨 Vulnerabilities: 
     - Digital alteration of PAC signatures【140†source】
     - Elevation of privilege vulnerability (CVE-2022-37967)【141†source】
     - Denial of Service Vulnerability【142†source】

4. **123/udp (NTP)**
   - Service: NTP v3
   - 🚨 Vulnerability: Denial of service by spoofed packets (CVE-2020-13817)【146†source】

5. **137/udp (NetBIOS-NS)**
   - Service: Microsoft Windows NetBIOS Name Service
   - 🚨 Vulnerabilities: 
     - Information retrieval risk【150†source】
     - LLMNR/NBT-NS poisoning and SMB Relay attacks【151†source】

6. **389/udp (LDAP)**
   - Service: Microsoft Windows Active Directory LDAP
   - 🚨 Vulnerability: Denial of service by a single message over LDAP port (CVE-2022-0918)【157†source】

### 🔑 Recommendations
- **🔧 Update & Patch:** Regularly update and patch all services, especially those with known vulnerabilities.
- **⚙️ Configuration Review:** Evaluate configurations for potential security weaknesses.
- **🔍 Regular Scanning:** Continuously monitor for emerging vulnerabilities.
- **🔒 Security Policies:** Implement robust security measures like access controls and firewalls.


