---
sticker: emoji//1f480
---
# NMAP Cheat Sheet 🖥️

## Table of Contents 📋





![[nmap-logo-256x256.png]]

## Ping Scanning 📡

```bash
nmap -sn 192.168.10.1
nmap -sP 192.168.10.2
```

## ARP Scanning 📶

```bash
nmap -sP -PR 192.168.10.1
```

> Note: Press the spacebar to show the current progression of the scan.

## SYN Scanning 👾

```bash
nmap -sS 192.168.10.1
```

## UDP Scanning 💾

```bash
nmap -sU 192.168.10.1
```

## Useful Nmap Switches ⚙️

- `h` : Help
- `v` : Verbose
- `vv` : Very Verbose
- `n` : No DNS Reverse Lookup
- `T` : Sets the speed of the scan (`T5` being the fastest, `T0` the slowest)
- `p` : Specify ports
    - `p 80` : Specific port
    - `p 1-10` : Range of ports
    - `p-` : All ports
- `o` : To output a file

## Identifying OS and Applications 🤖

- `sV` : Enable Version Detection
- `O` : Enable OS Detection
- `A` : Enable OS Detection, Version Detection, Script Scanning, and Traceroute
- `-osscan-guess` : Aggressive OS guessing

## Nmap Scripts 📜

**Syntax**: `nmap —script scriptname targetIP`

Examples:

```bash
nmap —script http-headers 192.168.10.1
nmap —script smtp-commands 192.168.10.1
nmap -sV --script=banner 192.168.10.1
nmap -sV --script=smb* 192.168.10.1
nmap --script=http-title 192.168.10.1
nmap --script=http-enum 192.168.10.0/24
```

> How to Use Nmap Script Engine (NSE) Scripts in Linux

## Batch Script for Nmap 💻

1. First, download Neovim or your favorite text editor. 📝
2. Create a file named `nmapScan.sh`.

```bash
#!/bin/bash

nmap -sT -p 1-10000 -vv -T5 -sV -O --osscan-guess --script=banner -oN 192.168.10.1TCP.txt 192.168.10.1

nmap -sU -p 1-500 -v -v --scan-delay 1s -sV --script=banner -oN 192.168.10.1UDP.txt 192.168.10.1

nmap -sT -p 1-10000 -v -v -T5 -sV -O --osscan-guess --script=banner -oN 192.168.10.2TCP.txt 192.168.10.2

nmap -sU -p 1-500 -v -v --scan-delay 1s -sV --script=banner -oN 192.168.10.2UDP.txt 192.168.10.2
```

1. Save and exit. 💾
2. Make the script executable:

```bash
sudo chmod +x nmapScan.sh
```

1. Run the script:

```bash
sudo ./nmapScan.sh
```


[PyScanner](https://github.com/00xNetrunner/PyScanner)

# PyScanner


![Kali](https://img.shields.io/badge/Kali-268BEE?style=for-the-badge&logo=kalilinux&logoColor=white)
----------
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
## Description
PyScanner is a comprehensive penetration testing toolkit designed to automate the process of network scanning and enumeration. The toolkit offers a simple and interactive menu-driven interface, empowering users to perform detailed scans using `nmap` and gather crucial information via `enum4linux`. Key features include OS detection, version scanning, banner grabbing, and user enumeration. The results from `nmap` are saved into text files while `enum4linux` output is directed into a specified text file for ease of analysis.

## Features
- Interactive menu for selecting the type of scan.
- Automated network scans with `nmap` for a range of TCP and UDP ports.
- Option to run `enum4linux` for comprehensive Windows machine enumeration.
- Customizable IP addresses, port ranges, usernames, and passwords for targeted scanning.
- Results from `nmap` are neatly organized into text files.
- `enum4linux` output is redirected to a desktop text file, `enum.txt`.

## Usage
To use PyScanner, follow the steps below:
1. Clone or download the `PyScanner.py` file from the repository.
2. Ensure you have `nmap` and `enum4linux` installed on your system.
3. Install the `termcolor` library using pip:
   ```bash
   pip install termcolor
   ```
4. cd into the PyScanner directory and give the file permissions when the file has perms, run it.:
	```bash
	# Give the file permissions
	sudo chmod +x PyScanner.py

	# Run the script
	sudo python3 PyScanner.py
	```

## The Code
```bash
# Leif R Bruce (00xNetrunner)
# 22.10.23
# PenTestToolkit made for Pen-testing

# This python script will use nmap and enum4linux for pen-testing
# REPORT ANY BUGS TO: leifbruce1996@zohomail.eu

import subprocess
from termcolor import colored, cprint

def run_nmap(target_ip, port_range):
    nmap_command = f"nmap -sV -p {port_range} {target_ip}"
    try:
        cprint(f"Running Nmap scan on {target_ip}...", 'blue')
        subprocess.run(nmap_command, shell=True, check=True)
    except subprocess.CalledProcessError as e:
        cprint(f"An error occurred while running Nmap: {e}", 'red')

def run_enum4linux(target_ip, username, password):
    enum_command = f"enum4linux -a -u {username} -p {password} {target_ip} > enum.txt"
    try:
        cprint(f"Running enum4linux on {target_ip}...", 'blue')
        subprocess.run(enum_command, shell=True, check=True)
    except subprocess.CalledProcessError as e:
        cprint(f"An error occurred while running enum4linux: {e}", 'red')

def main():
    ascii_art()
    cprint("Welcome to the PenTestToolkit.", 'green')
    cprint("[1] Run full Nmap scan", 'yellow')
    cprint("[2] Run enum4linux scan", 'yellow')

    choice = input("Enter your choice (1/2): ")
    
    if choice == '1':
        target_ip = input("Enter target IP address for Nmap scan: ")
        port_range = input("Enter port range for Nmap scan (default 1-65535): ") or "1-65535"
        run_nmap(target_ip, port_range)
    elif choice == '2':
        target_ip = input("Enter target IP address for enum4linux scan: ")
        username = input("Enter the username for enum4linux scan: ")
        password = input("Enter the password for enum4linux scan: ")
        run_enum4linux(target_ip, username, password)
    else:
        cprint("Invalid choice, exiting...", 'red')

if __name__ == "__main__":
    main()
```

###### Next Stage
[[Enumeration Stage Guide]]
# PDF For Reference 
![[Week 4 - NMAP Scanning.pdf]]



