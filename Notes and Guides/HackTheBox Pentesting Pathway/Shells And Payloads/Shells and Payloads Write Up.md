---
banner: https://academy.hackthebox.com/storage/modules/115/logo.png?t=1690811792
---
![[Pasted image 20240614211008.png]]

## Anatomy of a Shell
All OS system will have its own shell, we access these shells via a **terminal emulator**

the most common of these are programs like `PuTTY`, `Windows Terminal`,  `kitty`, and my favourite `Alacritty`

### Shell Validation
To find out what sort of lanuagh our shell is currently using. we can use the `ps`  command

![[shellValidation.png]]
As you can see when i run this command the language on my shell is fish, as i use fish as me default shell, you can also get `zsh` and `bash` which is probably the most  common shell, most linux distro will use bash fresh out the box. 

 ![[HTBqnda1.png]]


## Bind Shells
So with bind shells the target system with all the listener and it will be awaiting the pen-testers connection. this could be start via the hacker, being on site and having access to the victims system, and plugging in a USB, to start the listener, the hacker will then connect via their machine to the listener
![[Pasted image 20240614213533.png]]

their will be a lot of issue trying to get a shell via bind shells:
- ==There would have to be a listener already started on the target.==
- ==If there is no listener started, we would need to find a way to make this happen.==
- ==Admins typically configure strict incoming firewall rules and NAT (with PAT implementation) on the edge of the network (public-facing), so we would need to be on the internal network already.==
- ==Operating system firewalls (on Windows & Linux) will likely block most incoming connections that aren't associated with trusted network-based applications.==

### Practising with GNU Netcat. 
Lets have a bash at doing our bind shell. 

## Reverse Shell
Using a rev shell this time the pen tester system will be set up with the listener 
![[Pasted image 20240614221714.png]]

## Automating Payloads & Delivery with Metasploit

![[Pasted image 20240620194703.png]]

### Starting MSF

![[Pasted image 20240620193445.png|300]]

In this module we will be using the pentesting framework metasploit, metasploit could be considerd the swiss army knife of the hacking world, its capabilites are emmence and we would be here for days if i were to explain its full capabilites, one of these capabilites is reverse shell payloads, Metasploit is able to automate alot of the process of making a reverse shell. 

We can start metasploit with:-
```bash
sudo msfconsole 
```


### NMAP Scan
![[Pasted image 20240620194728.png]]

Before we can set up a reverse shell we need to first scan out target with NMAP, we do this to decide what service we should attack. 

use the following nmap scan 
```bash
nmap -sC -sV -Pn 10.129.195.0 -oX nmap_scan.xml -vv
```

the results will look like this:
![[Pasted image 20240620202901.png]]
> As we can see from the scan, we have smb services running, lets exploit one of them. the port running SMB is port 445

lets go back to `msfconsole` again it is started with the following command:
```bash
sudo msfconsole

search smb
```

you will see a long list of payloads. that are exploits for the smb service. we are going to be using a payload called psexec though 
![[Pasted image 20240620211606.png]]

![[Pasted image 20240620211731.png]]
> numbers at the far right are subject to change. 

|            |                                                                                                                                                                       |
| ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `exploit/` | This defines the type of module. In this case, this is an exploit module. Many exploit modules in MSF include the payload that attempts to establish a shell session. |
| `windows/` | This defines the platform we are targeting. In this case, we know the target is Windows, so the exploit and payload will be for Windows.                              |
| `smb/`     | This defines the service for which the payload in the module is written.                                                                                              |
| `psexec`   | This defines the tool that will get uploaded to the target system if it is vulnerable.                                                                                |

to select the payload enter the following command, or fight what number psexec is on

```bash
use 56
```
OR
```
use windows/smb/psexec
```

when the module is loaded, enter `show options`:
![[Pasted image 20240620212016.png]]

we are going to modify these settings to target out victims machine 

